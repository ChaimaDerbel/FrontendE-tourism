<div class="experience-search-container">
  <!-- Search Header -->
  <div class="search-header">
    <div class="header-content">
      <h1>Discover Amazing Experiences</h1>
      <p>Find unique activities and adventures around the world</p>
    </div>
    <button mat-raised-button color="primary" (click)="createExperience()" class="create-button">
      <mat-icon>add</mat-icon>
      Add Experience
    </button>
  </div>

  <!-- Advanced Search Form -->
  <mat-card class="search-card">
    <mat-card-content>
      <form [formGroup]="searchForm" class="search-form">
        <!-- Primary Search Row -->
        <div class="search-row primary-row">
          <mat-form-field appearance="outline" class="search-field">
            <mat-label>What are you looking for?</mat-label>
            <input matInput formControlName="search" placeholder="Search experiences...">
            <mat-icon matSuffix>search</mat-icon>
          </mat-form-field>

          <mat-form-field appearance="outline" class="location-field">
            <mat-label>Where?</mat-label>
            <input matInput formControlName="location" placeholder="Enter destination">
            <mat-icon matSuffix>location_on</mat-icon>
          </mat-form-field>

          <mat-form-field appearance="outline" class="date-field">
            <mat-label>When?</mat-label>
            <input matInput [matDatepicker]="picker" formControlName="availability" placeholder="Select date">
            <mat-datepicker-toggle matSuffix [for]="picker"></mat-datepicker-toggle>
            <mat-datepicker #picker></mat-datepicker>
          </mat-form-field>
        </div>

        <!-- Filters Row -->
        <div class="search-row filters-row">
          <mat-form-field appearance="outline" class="filter-field">
            <mat-label>Category</mat-label>
            <mat-select formControlName="category">
              <mat-option value="">All Categories</mat-option>
              <mat-option *ngFor="let category of categories" [value]="category">
                {{ category | titlecase }}
              </mat-option>
            </mat-select>
          </mat-form-field>

          <mat-form-field appearance="outline" class="filter-field">
            <mat-label>Difficulty</mat-label>
            <mat-select formControlName="difficulty">
              <mat-option value="">All Levels</mat-option>
              <mat-option *ngFor="let difficulty of difficulties" [value]="difficulty">
                {{ difficulty | titlecase }}
              </mat-option>
            </mat-select>
          </mat-form-field>

          <div class="price-range-container">
            <label class="price-label">Price Range</label>
            <div class="price-inputs">
              <mat-form-field appearance="outline" class="price-field">
                <mat-label>Min</mat-label>
                <input matInput type="number" formControlName="minPrice" [min]="0">
                <span matPrefix>$</span>
              </mat-form-field>
              <span class="price-separator">-</span>
              <mat-form-field appearance="outline" class="price-field">
                <mat-label>Max</mat-label>
                <input matInput type="number" formControlName="maxPrice" [min]="0">
                <span matPrefix>$</span>
              </mat-form-field>
            </div>
          </div>

          <button mat-stroked-button (click)="clearFilters()" class="clear-button">
            <mat-icon>clear</mat-icon>
            Clear
          </button>
        </div>
      </form>
    </mat-card-content>
  </mat-card>

  <!-- Search Results -->
  <div class="search-results">
    <!-- Results Header -->
    <div class="results-header">
      <h2>
        <span *ngIf="!isSearching">{{ totalExperiences }} experiences found</span>
        <span *ngIf="isSearching">Searching...</span>
      </h2>
    </div>

    <!-- Loading State -->
    <div *ngIf="isSearching" class="loading-container">
      <mat-spinner diameter="40"></mat-spinner>
      <p>Finding the best experiences for you...</p>
    </div>

    <!-- Experience Grid -->
    <div *ngIf="!isSearching && experiences.length > 0" class="experiences-grid">
      <mat-card 
        *ngFor="let experience of experiences" 
        class="experience-card"
        (click)="viewExperience(experience.id!)"
      >
        <div class="card-image">
          <img 
            [src]="experience.images[0] || 'https://images.pexels.com/photos/1591373/pexels-photo-1591373.jpeg'" 
            [alt]="experience.title"
            onerror="this.src='https://images.pexels.com/photos/1591373/pexels-photo-1591373.jpeg'"
          >
          <div class="card-overlay">
            <div class="price-badge">{{ formatPrice(experience.price, experience.currency) }}</div>
          </div>
        </div>

        <mat-card-content class="card-content">
          <div class="card-header">
            <h3>{{ experience.title }}</h3>
            <div class="rating">
              <mat-icon 
                *ngFor="let star of getStarRating(experience.rating)" 
                [class.filled]="star"
                class="star-icon"
              >
                {{ star ? 'star' : 'star_border' }}
              </mat-icon>
              <span class="rating-text">{{ experience.rating }}</span>
            </div>
          </div>

          <p class="description">{{ experience.shortDescription }}</p>

          <div class="card-details">
            <div class="detail-item">
              <mat-icon>location_on</mat-icon>
              <span>{{ experience.location }}</span>
            </div>
            <div class="detail-item">
              <mat-icon>schedule</mat-icon>
              <span>{{ formatDuration(experience.duration) }}</span>
            </div>
            <div class="detail-item">
              <mat-icon>group</mat-icon>
              <span>Up to {{ experience.maxParticipants }}</span>
            </div>
          </div>

          <div class="card-footer">
            <mat-chip-list>
              <mat-chip [class]="'category-' + experience.category">
                {{ experience.category | titlecase }}
              </mat-chip>
              <mat-chip [class]="'difficulty-' + experience.difficulty">
                {{ experience.difficulty | titlecase }}
              </mat-chip>
            </mat-chip-list>
          </div>
        </mat-card-content>
      </mat-card>
    </div>

    <!-- Empty State -->
    <div *ngIf="!isSearching && experiences.length === 0" class="empty-state">
      <mat-icon>explore_off</mat-icon>
      <h2>No experiences found</h2>
      <p>Try adjusting your search criteria or explore different categories.</p>
      <button mat-raised-button color="primary" (click)="clearFilters()">
        Clear Filters
      </button>
    </div>
  </div>
</div>